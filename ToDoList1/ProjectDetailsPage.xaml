<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="ToDoList1.ProjectDetailsPage"
             Title="Проект">

    <Grid RowDefinitions="Auto,*,Auto" Padding="20">

       
        <Border x:Name="ProjectHeaderBorder"
                Grid.Row="0"
                Margin="0,0,0,15"
                Stroke="#dee2e6"
                StrokeThickness="1"
                BackgroundColor="White">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="15"/>
            </Border.StrokeShape>

            
            <Grid x:Name="ViewModeGrid" IsVisible="True">
                <VerticalStackLayout Padding="20">
                    <Label x:Name="ProjectTitleLabel"
                           FontSize="24"
                           FontAttributes="Bold"
                           TextColor="#2c3e50"/>
                    <Label x:Name="ProjectDescriptionLabel"
                           FontSize="16"
                           TextColor="#7f8c8d"
                           Margin="0,10,0,0"/>
                </VerticalStackLayout>
            </Grid>

            
            <Grid x:Name="EditModeGrid" IsVisible="False" Padding="20">
                <VerticalStackLayout Spacing="15">
                    <Label Text="Название проекта" FontSize="16" FontAttributes="Bold"/>
                    <Entry x:Name="EditNameEntry" Placeholder="Название" />

                    <Label Text="Описание" FontSize="16" FontAttributes="Bold"/>
                    <Editor x:Name="EditDescEditor" HeightRequest="100" />

                    <HorizontalStackLayout Spacing="10">
                        <Button Text="Сохранить" Clicked="SaveEdit_Clicked" BackgroundColor="#27ae60" TextColor="White" CornerRadius="10"/>
                        <Button Text="Отмена" Clicked="CancelEdit_Clicked" BackgroundColor="#95a5a6" TextColor="White" CornerRadius="10"/>
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Grid>
        </Border>

        
        <Button x:Name="EditButton"
                Grid.Row="0"
                HorizontalOptions="End"
                VerticalOptions="Start"
                Margin="0,10"
                Text="✏️ Редактировать"
                Clicked="EditButton_Clicked"
                BackgroundColor="Transparent"
                TextColor="#3498db"
                FontSize="14"/>

        <CollectionView x:Name="TasksList"
                        Grid.Row="1"
                        Margin="0,0,0,15"
                        EmptyView="Нет задач">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border Stroke="#dee2e6"
                            StrokeThickness="1"
                            BackgroundColor="White"
                            Margin="0,0,0,10">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="12" />
                        </Border.StrokeShape>
                        <Grid ColumnDefinitions="Auto,*,Auto,Auto"
                              Padding="15">
                            <CheckBox Grid.Column="0"
                                      IsChecked="{Binding IsCompleted}"
                                      Color="#27ae60"
                                      VerticalOptions="Center"
                                      CheckedChanged="TaskCheckbox_Changed"/>

                            <VerticalStackLayout Grid.Column="1" Margin="10,0">
                                <Label Text="{Binding Name}" FontSize="16" TextColor="#2c3e50"/>
                                <Label Text="{Binding Description}" FontSize="12" TextColor="#7f8c8d"/>
                            </VerticalStackLayout>

                            <Button Grid.Column="2" Text="✏️" FontSize="12"
                                    CommandParameter="{Binding .}"
                                    Clicked="EditTask_Clicked"
                                    BackgroundColor="Transparent" WidthRequest="40"/>

                            <Button Grid.Column="3" Text="🗑️" FontSize="12"
                                    CommandParameter="{Binding .}"
                                    Clicked="DeleteTask_Clicked"
                                    BackgroundColor="Transparent" WidthRequest="40"/>
                        </Grid>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        
        <Button Text="+ Задача"
                Grid.Row="2"
                BackgroundColor="#3498db"
                TextColor="White"
                FontSize="16"
                CornerRadius="25"
                HeightRequest="50"
                Clicked="AddTask_Clicked"/>

    </Grid>
</ContentPage>